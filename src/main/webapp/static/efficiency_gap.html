<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
     <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.min.js"></script>
     <script src="http://d3js.org/d3.v2.js"></script>
     <script src="http://d3js.org/d3.v4.min.js"></script>
     <script src="https://d3js.org/d3-axis.v1.min.js"></script>
     <!--
     <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
     -->
     <script src="http://d3js.org/d3.v3.min.js"></script>


<!--
    <script type="text/javascript" src="/resources/js/main.js"></script>

    <script type="text/javascript">
      $(document).ready(function () {
        main();
      });
    </script>
    -->
    <link href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="/resources/style/efficiency_gap.css" rel="stylesheet" type="text/css">
    <style>


td, th {
  padding: 1px 50px;
}
      text{
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }



.toolTip {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    position: absolute;
    display: none;
    width: auto;
    height: auto;
    background: none repeat scroll 0 0 white;
    border: 0 none;
    border-radius: 8px 8px 8px 8px;
    box-shadow: -3px 3px 15px #888888;
    color: black;
    font: 12px sans-serif;
    padding: 5px;
    text-align: center;
}



.legend {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 60%;
}

rect {
    stroke-width: 2;
}

text {
  font: 10px sans-serif;
}

.axis text {
  font: 10px sans-serif;
}

.axis path{
  fill: none;
  stroke: #000;
}

.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.axis .tick line {
  stroke-width: 1;
  stroke: rgba(0, 0, 0, 0.2);
}

.axisHorizontal path{
  fill: none;
}

.axisHorizontal line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.axisHorizontal .tick line {
  stroke-width: 1;
  stroke: rgba(0, 0, 0, 0.2);
}

.bar {
  fill: steelblue;
  fill-opacity: .9;
}

.x.axis path {
  display: none;
}

    </style>
  </head>
  <body>
    <div class="section">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <ul class="nav nav-tabs">
              <li class="">
                <a href="./start page.html">Home</a>
              </li>
              <li class="active">
                <a href="./efficiency_gap.html"><i class="fa fa-fw fa-angle-double-right"></i>Analyze a State</a>
              </li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Learn More&nbsp;<i class="fa fa-caret-down"></i></a>
                <ul class="dropdown-menu" role="menu">
                  <li>
                    <a href="./learn more home page.html">Home Page</a>
                  </li>
                  <li class="divider"></li>
                  <li>
                    <a href="./Learn more_how tests work.html">How Tests Work</a>
                  </li>
                  <li class="divider"></li>
                  <li>
                    <a href="./learn more_legal efforts.html">Legal Efforts </a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="./Contact.html">Contact</a>
              </li>
              <li>
                <a href="./basic user redistricting.html">What If?</a>
              </li>
            </ul>
            <a href="#"><i class="fa fa-fw fa-lg fa-toggle-off"></i></a>
          </div>
        </div>
      </div>
    </div>
    <div id="carousel-example" data-interval="false" class="carousel slide" data-ride="carousel">
      <div class="carousel-inner">
        <div class="item active">
          <img src="https://ununsplash.imgix.net/photo-1413912623716-e6c688db0383?w=1024&amp;q=50&amp;fm=jpg&amp;s=2777ec88322e8725978f0fa956735021">
          <div class="carousel-caption">
            <h2>Gerrymandering in the United States</h2>
          </div>
        </div>
      </div>
      <a class="left carousel-control" href="#carousel-example" data-slide="prev"><i class="icon-prev  fa fa-angle-left"></i></a>
      <a class="right carousel-control" href="#carousel-example" data-slide="next"><i class="icon-next fa fa-angle-right"></i></a>
    </div>
    <div class="section">
      <div class="section">
        <div class="container">
          <div class="row">
            <div class="col-md-6">
              <br>
              <iframe style="width: 100%; height:400px" src="searchbox.html"></iframe>
            </div>
            <div class="col-md-6">
              <select id="box1" onChange="myFunction(this);" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" style="margin-right:10px">
              <option value="98">New York</option>
              <option value="7122">North Carolina</option>
              <option value="142">Virginia</option>
              </select>
              <select id="box2" onChange="myNewFunction(this);" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" style="margin-right:10px">
              <option value="98">2016</option>
              <option value="142">2014</option>
              <option value="142">2012</option>
              <option value="142">2010</option>
              <option value="142">2008</option>
              <option value="142">2006</option>
              <option value="142">2004</option>
              <option value="142">2002</option>
              <option value="142">2000</option>
              </select>
              <a class="btn btn-primary dropdown-toggle" href="whatif.html">Make Super Districts&nbsp;</a>
              <div id="selection"></div>
              <script>

/* secure selections from user as a variable for the tests in display state use case */

              var selectedState;
              var selectedYear;
              var selectedPair;

              function myFunction(element) {
                 selectedState = element.options[element.selectedIndex].text;
              }
              function myNewFunction(element) {
                 selectedYear = element.options[element.selectedIndex].text;
                 selectedPair=[
                 ["State",selectedState],
                 ["raceYear",selectedYear]
                 ];
                 document.getElementById("selection").innerHTML = "State Chosen for "+selectedPair[1][1]+" : "+selectedPair[0][1];
                 
              }

/* end of securing selections*/
              </script>
              <p>North Carolina, one of the original 13 colonies, entered the Union in
                November 1789. The state did not participate in the 1864 election due to
                secession. Like many other southern states, North Carolina voted almost
                exclusively Democratic from 1876 through 1964 and almost exclusively Republican
                beginning in 1968. The initial shift was largely in response to white conservative
                voter uneasiness with the civil rights legislation passed in the mid-1960s,
                which was effectively exploited by the Republicans “southern strategy.”
                <br>
                <br>In 2008, Barack Obama reversed the trend of Republican dominance here
                (although just barely), defeating John McCain by about 14,000 votes out
                of 4.3 million cast (49.7% to 49.4%). In percentage terms, it was the 2nd
                closest race of the 2008 election (behind Missouri). In 2012, North Carolina
                was again the 2nd closest race (this time behind Florida) as the state
                flipped Republican. Mitt Romney beat Obama by about 2%. Donald Trump won
                the state by 3.6% over Hillary Clinton in 2016. Based on population projections,
                the state may gain an additional electoral vote after the 2020 presidential
                election.
                <br>
              </p>
              <a class="btn btn-primary btn-sm" contenteditable="true" style="margin-right:10px">&nbsp; &nbsp; &nbsp; Read &nbsp;More &nbsp; &nbsp;</a>
              <a class="btn btn-primary btn-sm" style="margin-right:10px">&nbsp; &nbsp;Run Analysis- Congressional District&nbsp;</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="section">
      <div class="section">
        <div class="container">
          <div class="row">
            <div class="col-md-1">
              <a href="analyze.html"><i class="fa fa-5x fa-fw fa-toggle-off"></i></a>
            </div>
            <div class="col-md-5">
              <h1>Three Test Simulation</h1>
            </div>
            <div class="col-md-1">
              <a href="./efficiency_gap.html"><i class="fa fa-5x fa-fw fa-toggle-on"></i></a>
            </div>
            <div class="col-md-5">
              <h1>Efficiency Gap Simulation</h1>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="section">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <h1 class="text-primary">&nbsp; &nbsp; &nbsp;Calculated Votes for the Democrat Party and Republican Party</h1>
            
          </div>
          <div class="col-md-12" id= "tableDisplay">
          <!-- create table for displaying results of user selection
              -->
              
              <script>
                  var filters = [
                  ['State', 'Alabama'],
                  ['raceYear', '2012']
                  ];
                  d3.json('/resources/js/test.json', function (data) {
                     data = data.filter(function(row) {

                      return row['State'] == filters[0][1] && row['raceYear']==filters[1][1];
      
                  });
                  function tabulate(data, columns) {
                    var table = d3.select('#tableDisplay').append('table')
                    var thead = table.append('thead')
                    var tbody = table.append('tbody');

                  // append the header row
                  thead.append('tr')
                  .selectAll('th')
                  .data(columns).enter()
                  .append('th')
                  .text(function (column) { return column; });

                   // create a row for each object in the data
                   var rows = tbody.selectAll('tr')
                  .data(data)
                  .enter()
                  .append('tr');

                   // create a cell in each row for each column
                  var cells = rows.selectAll('td')
                  .data(function (row) {
                      return columns.map(function (column) {
                          return {column: column, value: row[column]};
                      });
                    })
                  .enter()
                  .append('td')
                  .text(function (d) { return d.value; });

                     return table;
                  }

                // render the table(s)
                tabulate(data, ['AreaNumber', 'DemVotes','DemStatus','RepVotes','RepStatus', 'Winner' ]); 

              });
              </script>

              
                
            </div>
        </div>
      </div>
    </div>
    <div class="section">
      <div class="container">
        <div class="row">
          
          <div class = "col-md-6" id="vis">
            <script>

var margin = {top: (10), right: (parseInt(d3.select('body').style('width'), 10)/20), bottom: (parseInt(d3.select('body').style('width'), 10)/5), left: (parseInt(d3.select('body').style('width'), 10)/20)},
    width = parseInt(d3.select('body').style('width'), 10) - margin.left - margin.right,
    width2 = width/3;
    height = parseInt(d3.select('body').style('height'), 10) - margin.top - margin.bottom,
    height2 = height/1.5;

var x0 = d3.scale.ordinal()
    .rangeRoundBands([0, width2], .1);

var x1 = d3.scale.ordinal();

var y = d3.scale.linear()
    .range([height, 0]);

var colorRange = d3.scale.category20();
var color = d3.scale.ordinal()
    .range(colorRange.range());

var xAxis = d3.svg.axis()
    .scale(x0)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left")
    .tickFormat(d3.format(".2s"));

var divTooltip = d3.select("#vis").append("div").attr("class", "toolTip");


var svg = d3.select("#vis").append("svg")
    .attr("width", width2 + margin.left + margin.right)
    .attr("height", height2 + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


//added

var demVotePercentage;
var democratWonState=0;
var republicanWonState=0;
var demVoteSum;
var repVoteSum; 
var demVotesArray;
var repVotesArray;
var usedToWinDemVotes;
var wastedDemVotes;
var usedToWinRepVotes;
var wastedRepVotes;
var demDistrictCount=0;
var repDistrictCount=0;
var winnerArray;
var filters = [
  ['State', 'New York'],
  ['raceYear', '2012']
];
   
d3.json("/resources/js/test.json", function(data) {
  data = data.filter(function(row) {

        return row['State'] == filters[0][1] && row['raceYear']==filters[1][1];
      
  });


    demVotesArray = data.map((e) => {
      return typeof e.DemVotes === 'string' ? parseInt(e.DemVotes.replace(",", "")) : e.DemVotes;
    });
    demVoteSum = demVotesArray.reduce(function(total,amount){
        return total + amount;
    }, 0);
    repVotesArray = data.map((e) => {
      return typeof e.RepVotes === 'string' ? parseInt(e.RepVotes.replace(",", "")) : e.RepVotes;
    });
    repVoteSum = repVotesArray.reduce(function(total,amount){
        return total + amount;
    }, 0);
    winnerArray = data.map((e)=>{
      return e['Winner'];
    });


  for(var i=0; i<winnerArray.length; i++)
{
  if(winnerArray[i]=="D")
  {
    demDistrictCount = demDistrictCount+1;
  }
  else if(winnerArray[i]=="R")
  {
    repDistrictCount = repDistrictCount+1;
  }
}
console.log("demDistrictCount: " + demDistrictCount);
console.log("repDistrictCount: " + repDistrictCount);

  if(demDistrictCount>repDistrictCount)
  {
    democratWonState=1;
  }
  else if(demDistrictCount < repDistrictCount){
    republicanWonState=1;

  }
  if(democratWonState==1)
  {
    usedToWinDemVotes = demVoteSum;
    wastedDemVotes = demVoteSum/2;
    usedToWinRepVotes = repVoteSum;
    wastedRepVotes = repVoteSum;
  }
  if(republicanWonState==1)
  {
    usedToWinRepVotes = repVoteSum;
    wastedRepVotes = repVoteSum/2;
    usedToWinDemVotes = demVoteSum;
    wastedDemVotes = demVoteSum;
  }

  var voteCounts = [
    [usedToWinDemVotes, wastedDemVotes],
    [usedToWinRepVotes, wastedRepVotes]
  ];
  console.log("usedToWinDemVotes: " + usedToWinDemVotes);

  console.log("wastedDemVotes: " + wastedDemVotes);

  console.log("usedToWinRepVotes: " + usedToWinRepVotes);

  console.log("wastedRepVotes: " + wastedRepVotes);

  var voteCounts1DArray = [usedToWinDemVotes, usedToWinRepVotes, wastedDemVotes, wastedRepVotes];


//end added
dataset = [
    {label:"Votes Needed to Win", "Democrat":usedToWinDemVotes, "Republican":usedToWinRepVotes},
    {label:"Votes Wasted", "Democrat":wastedDemVotes, "Republican":wastedRepVotes}
];


var options = d3.keys(dataset[0]).filter(function(key) { 
  return key !== "label";
   });

dataset.forEach(function(d) {
    d.valores = options.map(function(name) { 
      return {name: name, value: +d[name]};
       });
});

x0.domain(dataset.map(function(d) { 
  return d.label;
   }));
x1.domain(options).rangeRoundBands([0, x0.rangeBand()]);
y.domain([0, d3.max(dataset, function(d) { 
  return d3.max(d.valores, function(d) {
      return d.value; 
    });
 })]);

svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis);

svg.append("g")
    .attr("class", "y axis")
    .call(yAxis)
    .append("text")
    .attr("transform", "rotate(-90)")
    .attr("y", 6)
    .attr("dy", ".71em")
    .style("text-anchor", "end")
    .text("Vote Shares");

var bar = svg.selectAll(".bar")
    .data(dataset)
    .enter().append("g")
    .attr("class", "rect")
    .attr("transform", function(d) {
     return "translate(" + x0(d.label) + ",0)";
      });

bar.selectAll("rect")
    .data(function(d) { 
      return d.valores; 
    })
    .enter().append("rect")
    .attr("width", x1.rangeBand())
    .attr("x", function(d) { 
      return x1(d.name);
       })
    .attr("y", function(d) { 
      return y(d.value);
       })
    .attr("value", function(d){
      return d.name;
    })
    .attr("height", function(d) { 
      return height - y(d.value);
       })
    .style("fill", function(d) {
     return color(d.name);
      });
/*
//possible tool tip to further indicate results for bar chart 

bar.on("mousemove", function(d){
        divTooltip.style("left", d3.event.pageX+10+"px");
        divTooltip.style("top", d3.event.pageY-25+"px");
        divTooltip.style("display", "inline-block");
        var x = d3.event.pageX, y = d3.event.pageY
        var elements = document.querySelectorAll(':hover');
        l = elements.length
        l = l-1
        elementData = elements[l].getAttribute('rect');
        divTooltip.html((d.label)+"<br>"+elementData.name+"<br>"+elementData.value);
    });
bar.on("mouseout", function(d){
        divTooltip.style("display", "none");
    });

*/
var legend = svg.selectAll(".legend")
    .data(options.slice())
    .enter().append("g")
    .attr("class", "legend")
    .attr("transform", function(d, i) { 
      return "translate(0," + i * 20 + ")"; 
    });

legend.append("rect")
    .attr("x", width2 - 18)
    .attr("width", 18)
    .attr("height", 18)
    .style("fill", color);

legend.append("text")
    .attr("x", width2 - 24)
    .attr("y", 9)
    .attr("dy", ".35em")
    .style("text-anchor", "end")
    .text(function(d) {
     return d; 
   });
});
            </script>
          </div>
          <div class="col-md-6">
            <h1 class="text-primary">Did your state make the standard?</h1>
            <h1 class="text-success">PASS</h1>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo
              ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis
              dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies
              nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim.
              Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In
              enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum
              felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. Vivamus
              elementum semper nisi.
              <br>
              <br>
              <br>
              <br>
              <br>
              <br>
            </p>
            <a class="btn btn-primary" href="./Learn more_how tests work.html">Read More</a>
          </div>
        </div>
      </div>
    </div>
    <div class="section">
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <h1 class="text-primary">Two-Party Seat Margin</h1>
            <h3></h3>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo
              ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis
              dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies
              nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim.
              Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In
              enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum
              felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. Vivamus
              elementum semper nisi.
              <br>
              <br>
              <br>
              <br>
              <br>
              <br>
              <br>
            </p>
            <a class="btn btn-primary" href="./Learn more_how tests work.html">Read More</a>
          </div>
          <div class = "col-md-6" id="vis1"></div>
          <!--<div class="col-md-6">
              <br>
              <iframe style="width: 100%; height:400px" src="dual bar chart.html"></iframe>
            </div>-->
        </div>
      </div>
    </div>
    <div class="section">
      <div class="container">
        <div class="row">
        <div class = "col-md-6" id="vis2"></div>
          <!--<div class="col-md-6">
              <br>
              <iframe style="width: 100%; height:400px" src="dual bar chart.html"></iframe>
            </div>-->
          <div class="col-md-6">
            <h1 class="text-primary">Two-Party Vote Margin</h1>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo
              ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis
              dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies
              nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim.
              Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In
              enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum
              felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. Vivamus
              elementum semper nisi.
              <br>
            </p>
            <a class="btn btn-primary" href="./Learn more_how tests work.html">Read More</a>
          </div>
        </div>
      </div>
    </div>
    <footer class="section section-primary">
      <div class="container">
        <div class="row">
          <div class="col-sm-6">
            <h1>Gerrymandering of the U.S.</h1>
            <p>Lorem ipsum dolor sit amet, consectetur adipisici elit,
              <br>sed eiusmod tempor incidunt ut labore et dolore magna aliqua.
              <br>Ut enim ad minim veniam, quis nostrud</p>
          </div>
          <div class="col-sm-6">
            <p class="text-info text-right">
              <br>
              <br>
            </p>
            <div class="row">
              <div class="col-md-12 hidden-lg hidden-md hidden-sm text-left">
                <a href="#"><i class="fa fa-3x fa-fw fa-instagram text-inverse"></i></a>
                <a href="#"><i class="fa fa-3x fa-fw fa-twitter text-inverse"></i></a>
                <a href="#"><i class="fa fa-3x fa-fw fa-facebook text-inverse"></i></a>
                <a href="#"><i class="fa fa-3x fa-fw fa-github text-inverse"></i></a>
              </div>
            </div>
            <div class="row">
              <div class="col-md-12 hidden-xs text-right">
                <a href="#"><i class="fa fa-3x fa-fw fa-instagram text-inverse"></i></a>
                <a href="#"><i class="fa fa-3x fa-fw fa-twitter text-inverse"></i></a>
                <a href="#"><i class="fa fa-3x fa-fw fa-facebook text-inverse"></i></a>
                <a href="#"><i class="fa fa-3x fa-fw fa-github text-inverse"></i></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
  

</body></html>
